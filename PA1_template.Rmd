---
title: 'Reproducible Research: Peer Assessment 1'
output:
  word_document: default
  pdf_document: default
  html_document:
    keep_md: yes
---


## Loading and preprocessing the data

Load the data and convert the date column into date data type.

```{r}
Sys.setlocale("LC_TIME", "C")
unzip("activity.zip")
data  <- read.csv("activity.csv")
data$date <- as.Date(data$date)
```




## What is mean total number of steps taken per day?

Calculate the total daily steps.
```{r}
daydata <- aggregate(steps ~ date, data, FUN = sum)
```

Draw a histogram of the daily step amounts.
```{r}
hist(daydata$steps, xlab = "Steps")
```

Calculate the mean and median number of steps.
```{r}
mean(daydata$steps)
median(daydata$steps)
```



## What is the average daily activity pattern?

Calculate the mean number of steps in an interval.
```{r}
intervaldata <- aggregate(steps ~ interval, data, FUN = mean)
```

Create a time series plot.
```{r}
plot(intervaldata$interval, intervaldata$steps, type = "l", xlab = "Interval", ylab = "Steps")
```


Find the interval containing maximum average number of steps.
```{r}
intervaldata[ max( intervaldata$steps ) == intervaldata$steps,]
```


## Imputing missing values

Missing values is the TRUE column.
```{r}
table( is.na( data$steps ) )
```

Replace the missing values with the mean for that interval.


## Are there differences in activity patterns between weekdays and weekends?


Create a factor separating weekend from weekdays.
```{r}
data$day[ weekdays( data$date ) %in% c("Saturday", "Sunday")] <- "weekend"
data$day[ is.na( data$day ) ] <- "weekday"
data$day  <- as.factor(data$day)
```


